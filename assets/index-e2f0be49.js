var Q=Object.defineProperty;var V=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var x=(e,t,n)=>(V(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function q(e,t){return e.canvas.width=t.displayWidth_px,e.canvas.height=t.displayHeight_px,{ctx:e,dm:t}}function E(e){const[t,n,o]=e;return`rgb(${t},${n},${o})`}function tt(e,t){const{borderColor:n,borderWidth_du:o,scale:r,displayHeight_du:i,displayWidth_du:c}=t;if(o<1)return;const{strokeRect_du:u,ctx:l}=e(r);return l.strokeStyle=E(n),l.lineWidth=o*r,u(o/2,o/2,c-o,i-o),{ctx:l,dm:t}}const et={scale:2,displayRows:8,gridSpaceX_du:-3,gridSpaceY_du:5,borderColor:[200,0,120],borderWidth_du:0,borderGutter_du:5};function Y(e,t,n){const{scale:o,displayRows:r,gridSpaceX_du:i,gridSpaceY_du:c,borderColor:u,borderWidth_du:l,borderGutter_du:h}=n,p=l*2+h*2,w=t.clientWidth-p*o,C=nt(w,o,e,i),b=e+c,R=r-1,d=C-1,S=p+r*e+R*c,A=S*o,k=e,I=e,L=C*k+d*i+p,a=L*o,s=l+h,f=l+h,g=L-(h+l)*2,m=S-(h+l),_=g-s,y=m-f;return{displayWidth_px:a,displayHeight_px:A,displayWidth_du:L,displayHeight_du:S,displayUnitsPerRow_du:b,displayColumns:C,displayRows:r,borderWidth_du:l,totalBorderWidth_du:p,borderGutter_du:h,remainingWidthXPx:w,scale:o,gridSpaceX_du:i,gridSpaceY_du:c,borderColor:u,drawAreaLeft_du:s,drawAreaTop_du:f,drawAreaRight_du:g,drawAreaBottom_du:m,drawAreaWidth_du:_,drawAreaHeight_du:y,cellWidth_du:k,cellHeight_du:I,getColumnXCoord_du(T){return T*k+i*T+s},getColumnFromXCoord_du(T){let X=0,$=0;for(;$!==T-s;)$+=k+i,X+=1;return X},getRemainingRowSpace_du(T){return L-T-s},measureText(T){return T.length*k+(T.length-1)*i},textFits(T,X){return this.measureText(T)<=this.getRemainingRowSpace_du(X)}}}function nt(e,t,n,o){let r=e,i=0;const c=n*t+o*t;for(;r+o*t>c;)r-=c,i++;return i}function j(e,t,n,o=null,r=0){const i=t(n,e,o,r);return e.children.length>0?e.children.reduce((u,l)=>j(l,t,u,e,r+1),i):i}const ot=["highlight","color","outline"];class N{constructor(t,n){x(this,"__text");x(this,"__parent");x(this,"__children");this.__text=t,this.__parent=n,this.__children=[]}get text(){return this.__text}get parent(){return this.__parent}get children(){return this.__children}toString(){return`${this.__text}`.trim()}get nextSibling(){if(this.parent){const t=this.parent.children.findIndex(o=>o===this);return this.parent.children[t+1]}}get ancestorAttributes(){return G(this,{})}}function G(e,t){return e.parent?G(e.parent,e instanceof B?{...e.attributes,...t}:t):t}class B{constructor(t,n,o){x(this,"__tagName");x(this,"__attributes");x(this,"__parent");x(this,"__children");this.__tagName=t,this.__attributes=o,this.__parent=n,this.__children=[]}get tag(){return this.__tagName}get attributes(){return this.__attributes}get parent(){return this.__parent}get children(){return this.__children}toString(){return`<${this.__tagName} ${Object.entries(this.__attributes).map(([t,n])=>`${t}=${n}`).join(" ")}>`.trim()}get nextSibling(){if(this.parent){const t=this.parent.children.findIndex(o=>o===this);return this.parent.children[t+1]}}}function H(e){let t="";const n=[];let o=!1;for(const i of e.trim())i==="<"?(o=!0,t&&(M(n,t.trim()),t="")):i===">"?(o=!1,n.length===0&&t!=="root"&&P(n,"root"),P(n,t),t=""):t+=i;return!o&&t&&M(n,t),rt(n)}function M(e,t){if(t.trim().length===0)return;const n=e.at(-1);if(n){const o=new N(t,n);n.children.push(o)}else P(e,"root"),M(e,t)}function P(e,t){if(t.startsWith("/")){if(e.length===1)return;const n=e.pop(),o=e.at(-1);n&&(o==null||o.children.push(n))}else{const[n,o]=it(t),r=e.at(-1),i=new B(n,r,o);e.push(i)}}function rt(e){for(e.length===0&&P(e,"root");e.length>1;){const t=e.pop(),n=e.at(-1);t&&n instanceof B&&(n==null||n.children.push(t))}return e.pop()}function it(e){const[t,...n]=e.split(" "),o=n.reduce((r,i)=>{const[c,u]=i.split("=");return st(c)&&(r[c]=ut(u)),r},{});return[t,o]}function st(e){return ot.includes(e)}function at(e){return j(e,(n,o,r,i)=>(n.out=n.out+`
`+" ".repeat(i*2)+o.toString(),n),{out:""}).out}function ut(e){switch(e){case"true":return!0;case"false":return!1;case"null":return null;default:return e}}function ct(e){const{dm:t,simpleText:n}=e,o=[],r=t.cellWidth_du+t.gridSpaceX_du,i=t.cellHeight_du+t.gridSpaceY_du,c=t.getColumnXCoord_du(t.displayColumns-1);let u=t.drawAreaLeft_du,l=t.drawAreaTop_du;"initialCursor"in e&&(u=e.initialCursor.x,l=e.initialCursor.y);for(const h of n){if(o.push({x:u,y:l,char:h}),h===`
`){u=t.drawAreaLeft_du,l+=i;continue}u===t.getColumnXCoord_du(0)&&h===" "||(u>=c?(u=t.drawAreaLeft_du,l+=i):u+=r)}return"initialCursor"in e?{layoutList:o,x:u,y:l}:o}function D({tree:e,dm:t,initCursorX_du:n,initCursorY_du:o}){at(e);const r={layoutList:[],xStep:t.cellWidth_du+t.gridSpaceX_du,yStep:t.cellHeight_du+t.gridSpaceY_du,cursorX_du:n??t.drawAreaLeft_du,cursorY_du:o??t.drawAreaTop_du};return j(e,(i,c)=>(c.tag==="p"&&(i.cursorY_du+=i.yStep,i.cursorX_du=t.drawAreaLeft_du),c instanceof N&&lt(c,i,t),i),r).layoutList}function lt(e,t,n){const o=e.text.split(" ");for(const[r,i]of o.entries()){if(i.length===0)continue;!n.textFits(i,t.cursorX_du)&&t.cursorX_du!==n.drawAreaLeft_du&&(t.cursorX_du=n.drawAreaLeft_du,t.cursorY_du+=t.yStep);const{layoutList:c,x:u,y:l}=ct({simpleText:i,dm:n,initialCursor:{x:t.cursorX_du,y:t.cursorY_du}});c.forEach(p=>t.layoutList.push({...p,attributes:e.ancestorAttributes})),t.cursorX_du=u,t.cursorY_du=l,t.cursorX_du!==n.drawAreaLeft_du&&(t.layoutList.push({x:t.cursorX_du,y:t.cursorY_du,char:" ",attributes:r===o.length-1?{}:e.ancestorAttributes}),t.cursorX_du+=t.xStep)}}function dt(e,t){function n(a){if(a<1)throw new Error("cannot set scale less than 1");if(a>10)throw new Error("cannot set scale greater than 10");e.setState(s=>({...s,dm:Y(s.dm.cellWidth_du,s.root,{...t,scale:a,displayRows:s.dm.displayRows,gridSpaceX_du:s.dm.gridSpaceX_du,gridSpaceY_du:s.dm.gridSpaceY_du})}))}function o(a){if(a<1)throw new Error("cannot set display rows less than 1");if(a>40)throw new Error("cannot set display rows greater than 40");e.setState(s=>({...s,dm:Y(s.dm.cellWidth_du,s.root,{...t,scale:s.dm.scale,displayRows:a,gridSpaceX_du:s.dm.gridSpaceX_du,gridSpaceY_du:s.dm.gridSpaceY_du})}))}function r(a){if(a<0)throw new Error("cannot set negative gridSpace");if(a>5)throw new Error("cannot set gridSpace greater than 5");e.setState(s=>({...s,dm:Y(s.dm.cellWidth_du,s.root,{...t,scale:s.dm.scale,displayRows:s.dm.displayRows,gridSpaceX_du:a,gridSpaceY_du:a})}))}function i(a){e.setState(s=>({...s,dm:Y(s.dm.cellWidth_du,s.root,{...t,scale:s.dm.scale,displayRows:s.dm.displayRows,gridSpaceX_du:a})}))}function c(a){e.setState(s=>({...s,dm:Y(s.dm.cellWidth_du,s.root,{...t,scale:s.dm.scale,displayRows:s.dm.displayRows,gridSpaceY_du:a})}))}function u(a){e.setState(s=>({...s,scrollY_du:a}))}function l(a=1){e.setState(s=>{const{drawAreaTop_du:f}=s.dm,{scrollY_du:g,layoutList:m}=s,_=m.at(-1).y-f;return{...s,scrollY_du:g>=_?g:g+a}})}function h(a=1){e.setState(s=>({...s,scrollY_du:s.scrollY_du-a>=0?s.scrollY_du-a:s.scrollY_du}))}function p(a=1){const{layoutList:s,scrollY_du:f,dm:g}=e.getState(),m=g.cellHeight_du+g.gridSpaceY_du,_=Math.min(f+m,s.at(-1).y-g.drawAreaTop_du);function y(){e.getState().scrollY_du>=_||(l(a),requestAnimationFrame(y))}requestAnimationFrame(y)}function w(a=1){const{scrollY_du:s,dm:f}=e.getState(),g=f.cellHeight_du+f.gridSpaceY_du,m=Math.max(0,s-g);function _(){e.getState().scrollY_du<=m||(h(a),requestAnimationFrame(_))}requestAnimationFrame(_)}function C(a){return a<.5?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1}function b(a){const s=e.getState().scrollY_du,f=s<a?"down":"up";let g=0;e.setState({isScrolling:!0});function m(){const _=C(g/60);if(f==="down"){const y=s+_*(a-s);if(y>=a){e.setState({scrollY_du:a,isScrolling:!1});return}else e.setState({scrollY_du:y})}else if(f==="up"){const y=s-_*(s-a);if(y<=a){e.setState({scrollY_du:a,isScrolling:!1});return}else e.setState({scrollY_du:y})}g++,requestAnimationFrame(m)}requestAnimationFrame(m)}function R(){const{dm:a,scrollY_du:s,isScrolling:f}=e.getState(),{displayRows:g,gridSpaceY_du:m,cellHeight_du:_}=a,y=s+g*(m+_);f||b(y)}function d(){const{dm:a,scrollY_du:s,isScrolling:f}=e.getState(),{displayRows:g,gridSpaceY_du:m,cellHeight_du:_}=a,y=s-g*(m+_);f||b(y<0?0:y)}function S(){const{isScrolling:a}=e.getState();a||b(0)}function A(){const{dm:a,isScrolling:s,layoutList:f}=e.getState(),{borderGutter_du:g,borderWidth_du:m}=a,_=f.at(-1).y-g-m;s||b(_)}function k(a){const{layoutList:s,dm:f,scrollY_du:g}=e.getState(),{y:m}=s.at(-1)??{y:f.drawAreaTop_du},_=H(`<p>${a}</p>`),y=D({tree:_,dm:f,initCursorX_du:f.drawAreaLeft_du,initCursorY_du:m});y[0].y-4>g+f.drawAreaHeight_du&&b(y[0].y-4),e.setState(T=>({...T,layoutList:T.layoutList.concat(y),documentSource:T.documentSource+`<p>${a}</p>`}))}function I(a){const s=H(a),{dm:f}=e.getState();e.setState({layoutList:D({dm:f,tree:s}),documentSource:a,scrollY_du:0})}return{setScale:n,setRows:o,setGridSpace:r,setGridSpaceX:i,setGridSpaceY:c,setScroll:u,scrollDown:l,scrollUp:h,pageDown:R,pageUp:d,home:S,end:A,appendText:k,setText:I,animatedScrollDown:p,animatedScrollUp:w}}function ht({index:e,columns:t}){if(e>=0){const n=Math.floor(e/t);return{x:e%t,y:n}}if(e<0){const n=Math.floor(e/t);return{x:e%t===0?e%t:e%t+t,y:n}}return{x:0,y:0}}function ft(e,t){const n=[];for(let o=0;o<t*t;o++)e.includes(o)||n.push(o);return n}function F(...e){return(...t)=>e.reduceRight((n,o)=>o(n),...t)}function gt(e,t,n){switch(n){case"start":return pt(e,t);case"middle":return wt(e,t);case"end":return mt(e,t);default:return e}}function pt(e,t){const n=[...e];return F(z,U,_t)([n,t])[0]}function wt(e,t){const n=[...e];return F(z,U)([n,t])[0]}function mt(e,t){const n=[...e];return F(z,U,yt)([n,t])[0]}function z(e){const[t,n]=e,o=-n,r=-1,i=1;return[t.concat(v(o,r,i)),n]}function U(e){const[t,n]=e,o=n*n,r=n*n+(n-1),i=1;return[t.concat(v(o,r,i)),n]}function _t(e){const[t,n]=e,o=0,r=n*n,i=n;return[t.concat(v(o,r,i)),n]}function yt(e){const[t,n]=e,o=n-1,r=n*n+(n-1),i=n;return[t.concat(v(o,r,i)),n]}function v(e,t,n){const o=[];for(let r=e;r<t+1;r+=n)o.push(r);return o}function bt(e){return function(r){const{getTools:i,charDefs:c,dm:u,scrollY_du:l}=e.getState(),{ctx:h,clearRect_du:p}=i(u.scale);h.fillStyle=E(u.borderColor),p(u.drawAreaLeft_du,u.drawAreaTop_du-2,u.drawAreaRight_du,u.drawAreaHeight_du+3);for(let w=0;w<r.length;w++){const{x:C,y:b,char:R,attributes:d}=r[w];if(b>l+u.drawAreaBottom_du||b+u.cellHeight_du<l)continue;const S=R.toUpperCase()in c?R.toUpperCase():" ",A=d!=null&&d.highlight?ft(c[S],c.charWidth):c[S];if(h.fillStyle=(d==null?void 0:d.color)??E(u.borderColor),t(A,C,b),d!=null&&d.outline){h.fillStyle=typeof(d==null?void 0:d.outline)=="string"?d==null?void 0:d.outline:E(u.borderColor);const k=gt([],c.charWidth,n(r,w));t(k,C,b)}}};function t(o,r,i){const{getTools:c,dm:u,scrollY_du:l}=e.getState(),{fillRect_du:h}=c(u.scale);o.forEach(p=>{const{x:w,y:C}=ht({index:p,columns:u.cellWidth_du}),b=w+r,R=C+i-l;u.drawAreaBottom_du<R||R<u.drawAreaTop_du-2||b>u.drawAreaRight_du+2||h(b,R,1,1)})}function n(o,r){var u,l,h,p;const i=o[r-1],c=o[r+1];return(u=i==null?void 0:i.attributes)!=null&&u.outline?(l=i==null?void 0:i.attributes)!=null&&l.outline&&((h=c==null?void 0:c.attributes)!=null&&h.outline)?"middle":(p=c==null?void 0:c.attributes)!=null&&p.outline?null:"end":"start"}}function J(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),o=Object.keys(t);if(n.length===0&&o.length===0)return!0;if(n.length!==o.length||o.some(r=>!n.includes(r)))return!1;for(const r of n)if(!o.includes(r)||!J(e[r],t[r]))return!1;return!0}return typeof e!=typeof t?!1:typeof e=="function"&&typeof t=="function"?e.toString()===t.toString():!1}function St(e){let t=e;const n=new Map;function o(u,l){for(const h of n.keys())if(h.toString()===l.toString())throw new Error("duplicate subscriber implementation found");return n.set(l,{selector:u,prevSelectorResult:u(t)}),()=>{n.delete(l)}}function r(){const u=[];for(const[l,{selector:h,prevSelectorResult:p}]of n){const w=h(t);J(w,p)||(n.set(l,{selector:h,prevSelectorResult:w}),u.push(l))}u.forEach(l=>{var h;l((h=n.get(l))==null?void 0:h.prevSelectorResult)})}function i(u){let l;typeof u=="function"?l=u(t):l={...t,...u},t=l,r()}function c(){return t}return{getState:c,setState:i,subscribe:o}}function Tt(e){const t=document.createElement("canvas");return t.setAttribute("id","__PTRwindow_canvas_element"),t.style.background="black",e.appendChild(t),t}function Ct(e,t){const n=document.createElement("div");return n.setAttribute("id",`__PTRwindow_root_element-${t}`),n.classList.add("PTRwindow_root_element"),n.style.boxSizing="border-box",e.appendChild(n),n}const W=3;function Rt(e){const{charWidth:t}=e;return Object.fromEntries(Object.entries(e).map(([n,o])=>n==="charWidth"&&typeof o=="number"?[n,o+W*2]:typeof o=="number"?[n,o]:[n,o.map(r=>{const i=Math.floor(r/t),l=(t+W*2)*W+W+i*W*2;return r+=l})]))}const kt={0:[2,3,4,8,12,15,18,19,22,24,26,29,30,33,36,40,44,45,46],1:[3,9,10,17,24,31,38,43,44,45,46,47],2:[2,3,4,8,12,19,24,25,30,36,43,44,45,46,47],3:[2,3,4,8,12,19,24,25,26,33,36,40,44,45,46],4:[4,10,11,16,18,22,25,29,30,31,32,33,39,46],5:[1,2,3,4,5,8,15,16,17,18,26,33,36,40,44,45,46],6:[2,3,4,8,12,15,22,23,24,25,29,33,36,40,44,45,46],7:[1,2,3,4,5,12,18,24,30,37,44],8:[2,3,4,8,12,15,19,23,24,25,29,33,36,40,44,45,46],9:[2,3,4,8,12,15,19,23,24,25,26,33,40,44,45,46],charWidth:7," ":[],".":[36],",":[36,43],"'":[3,10],A:[3,9,11,15,19,22,26,29,30,31,32,33,36,40,43,47],B:[1,2,3,4,8,12,15,19,22,23,24,25,29,33,36,40,43,44,45,46],C:[2,3,4,8,12,15,22,29,36,40,44,45,46],D:[1,2,3,8,11,15,19,22,26,29,33,36,39,43,44,45],E:[1,2,3,4,5,8,15,22,23,24,25,29,36,43,44,45,46,47],F:[1,2,3,4,5,8,15,22,23,24,25,29,36,43],G:[2,3,4,8,12,15,22,29,31,32,33,36,40,44,45,46],H:[1,5,8,12,15,19,22,23,24,25,26,29,33,36,40,43,47],I:[1,2,3,4,5,10,17,24,31,38,43,44,45,46,47],J:[5,12,19,26,29,33,36,40,44,45,46,47],K:[1,5,8,11,15,17,22,23,29,31,36,39,43,47],L:[1,8,15,22,29,36,43,44,45,46,47],M:[1,5,8,9,11,12,15,17,19,22,26,29,33,36,40,43,47],N:[1,5,8,9,12,15,17,19,22,24,26,29,31,33,36,39,40,43,47],O:[2,3,4,8,12,15,19,22,26,29,33,36,40,44,45,46],P:[1,2,3,4,8,12,15,19,22,23,24,25,29,36,43],Q:[2,3,4,8,12,15,19,22,26,29,31,33,36,39,44,45,47],R:[1,2,3,4,8,12,15,19,22,23,24,25,29,31,36,39,43,47],S:[2,3,4,8,12,15,23,24,25,33,36,40,44,45,46],T:[1,2,3,4,5,10,17,24,31,38,45],U:[1,5,8,12,15,19,22,26,29,33,36,40,44,45,46],V:[1,5,8,12,15,19,22,26,29,33,37,39,45],W:[1,5,8,12,15,19,22,26,29,31,33,36,37,39,40,43,47],X:[0,6,8,12,16,18,24,30,32,36,40,42,48],Y:[1,5,8,12,16,18,24,31,38,45],Z:[1,2,3,4,5,12,18,24,30,36,43,44,45,46,47],"!":[8,15,22,36],"-":[23,24,25],"+":[10,17,22,23,24,25,26,31,38],_:[37,38,39],">":[2,10,18,26,32,32,38,44],"<":[4,10,16,22,30,30,38,46],"(":[3,9,15,22,29,37,45],")":[3,11,19,26,33,39,45],"?":[2,3,4,8,12,15,19,25,31,45],$:[3,9,10,11,12,15,17,22,23,24,25,31,33,36,37,38,39,45],"*":[3,8,10,12,16,17,18,24,30,32,36,40],"/":[12,18,24,30,36],"\\":[8,16,24,32,40],"|":[3,10,17,24,31,38,45],"^":[3,9,11,15,19],"{":[3,4,9,16,22,30,37,45,46],":":[22,36],";":[22,36,43],"}":[1,2,10,17,25,31,38,43,44],'"':[2,4,9,11],"%":[8,12,18,24,30,36,40],"@":[1,2,3,4,5,7,13,14,16,17,18,20,21,23,25,27,28,30,31,32,33,35,43,44,45,46],"#":[9,11,15,16,17,18,19,23,25,29,30,31,32,33,37,39],"&":[2,3,4,8,12,15,22,23,25,26,27,29,33,36,40,44,45,46],"`":[0,8],"~":[19,23,24,25,29]};function xt(e){return(...t)=>t.map(n=>n*e)}function Yt(e){let t,n,o;return r=>{if(t===e&&n===r&&o)return o;const i=At(e,r);return t=e,n=r,o=i,i}}function At(e,t){const n=xt(t),o=r=>(...i)=>{const c=n(...i);return r.call(e,...c)};return{ctx:e,moveTo_du(...r){return o(e.moveTo)(...r)},lineTo_du(...r){return o(e.lineTo)(...r)},drawRect_du(...r){return o(e.rect)(...r)},fillRect_du(...r){return o(e.fillRect)(...r)},strokeRect_du(...r){return o(e.strokeRect)(...r)},clearRect_du(...r){return o(e.clearRect)(...r)}}}const Lt=e=>{const t=Rt(kt),n=Ct(e.containerElement),o=Tt(n).getContext("2d"),r=Y(t.charWidth,n,e.displayOptions),i=Yt(o);return St({...{dm:r,charDefs:t,root:n,ctx:o,getTools:i,documentSource:"",scrollY_du:0,layoutList:[],isScrolling:!1},...e})};function Wt(e,t){const n={...et,...t},o=Lt({displayOptions:n,containerElement:e}),r=dt(o,n),i=bt(o),{getTools:c,ctx:u,charDefs:l,root:h,documentSource:p}=o.getState(),w=Y(l.charWidth,h,n);q(u,w),tt(c,w);const C=H(p),b=D({tree:C,dm:w});i(b),window.addEventListener("resize",R),o.setState(d=>({...d,dm:w,layoutList:b})),o.subscribe(({dm:d,ctx:S})=>({dm:d,ctx:S}),({dm:d,ctx:S})=>{q(S,d);const A=H(o.getState().documentSource);o.setState({layoutList:D({dm:d,tree:A})})}),o.subscribe(({layoutList:d,dm:S})=>({layoutList:d,dm:S}),({layoutList:d})=>{i(d)}),o.subscribe(({scrollY_du:d})=>({scrollY_du:d}),()=>{i(o.getState().layoutList)});function R(){const d=Y(o.getState().dm.cellWidth_du,o.getState().root,{...n,scale:o.getState().dm.scale,displayRows:o.getState().dm.displayRows});o.getState().dm.displayColumns!==d.displayColumns&&o.setState(S=>({...S,dm:d}))}return{actions:r,store:o}}const K=Wt(document.getElementById("root"),{scale:2});window._PTR=K;const Xt=`
<span>
  <span outline=true>
    Resistance is futile
  </span>
  <p highlight=true>
    Resistance is futile
  </p>
  <p>We are the Borg. Lower your shields and surrender your ships. We will add your biological and technological distinctiveness to our own. Your culture will adapt to service us.</p>
</span>
`;K.actions.setText(Xt);const Et='<span highlight=true> The</span> <span outline=true>sky above the port</span> <span outline=true>was</span> the color of <span highlight=true color=rgb(0,220,200) outline=false>television, tuned to a dead channel. </span>"It’s not like I’m using," Case heard someone say, as he shouldered his way through the crowd around the door of the Chat. “It’s like my body’s developed this massive drug deficiency.” It was a Sprawl voice and a Sprawl joke. The Chatsubo was a bar for professional expatriates; you could drink there for a week and never hear two words in Japanese.            Ratz was tending bar, h is prosthetic arm jerking monotonously as he filled a tray of glasses with draft Kirin. He saw Case and smiled, his teeth a webwork of East European steel and brown decay. Case found a place at the bar, between the unlikely tan on one of Lonny Zone’s whores and the crisp naval uniform of a tall African whose cheekbones were ridged with precise rows of tribal scars. “Wage was in her early, with two joeboys,” Ratz said, shoving a draft across the bar with his good hand. “Maybe some business with you, Case?”            Case shrugged. The girl to his right giggled and nudged him.            The bartender’s smile widened. His ugliness was the stuff of legend. In an age of affordable beauty, there was something heraldic about his lack of it. The antique arm whined as he reached for another mug. It was a Russian military prosthesis, a seven-function force-feedback manipulator, cased in grubby pink plastic. “You are too much the artiste, Herr Case.” Ratz grunted; the sound served him as laughter. He scratched his overhang of white-shirted belly with the pink claw. “You are the artiste of the slightly funny deal.”            “Sure,” Case said, and sipped his beer. “Somebody’s gotta be funny around here. Sure the fuck isn’t you.”            The whore’s giggle went up an octave.            “Isn’t you either, sister. So you vanish, okay? Zone, he’s a close personal friend of mine.”            She looked Case in the eye and made the softest possible spitting sound, her lips barely moving. But she left.            “Jesus,” Case said, “what kinda creepjoint you running here? Man can’t have a drink?”            “Ha,” Ratz said, swabbing the scarred wood with a rag, “Zone shows a percentage. You I let work here for entertainment value.”            As Case was picking up his beer, one of those strange instants of silence descended, as though a hundred unrelated conversations had simultaneously arrived at the same pause. Then the whore’s giggle rang out, tinged with certain hysteria.            Ratz grunted. “An angel has passed.”            “The Chinese,” bellowed a drunken Australian, “Chinese bloody invented nerve-splicing. Give me the mainland for a nerve job any day. Fix you right, mate…;”            “Now that,” Case said to his glass, all his bitterness suddenly rising in him like bile, “that is so much bullshit.”             The Japanese had already forgotten more neurosurgery than the Chinese had ever known. The black clinics of Chiba were the cutting edge, whole bodies of technique supplanted monthly, and still they couldn’t repair the damage he’d suffered in that Memphis hotel.            A year here and he still dreamed of cyberspace, hope fading nightly. All the speed he took, all the turns he’d taken and the corners he’d cut in Night City, and still he’d see the matrix in his sleep, bright lattices of logic unfolding across that colorless void…;The Sprawl was a long strange way home over the Pacific now, and he was no console man, no cyberspace cowboy. Just another hustler, trying to make it through. But the dreams came on in the Japanese night like livewire voodoo, and he’d cry for it, cry in his sleep, and wake alone in the dark, curled in his capsule in some coffin hotel, his hands clawed into the bedslab, temperfoam bunched between his fingers, trying to reach the console that wasn’t there.             “I saw your girl last night,” Ratz said, passing Case his second Kirin.            “I don’t have one,” he said, and drank.            “Miss Linda Lee.”            Case shook his head.            “No girl? Nothing? Only biz, friend artiste? Dedication to commerce?” The bartender’s small brown eyes were nested deep in wrinkled flesh. “I think I liked you better, with her. You laughed more. Now, some night, you get maybe too artistic; you wind up in the clinic tanks, spare parts.”            “You’re breaking my heart, Ratz.” He finished his beer, paid and left, high narrow shoulders hunched beneath the rainstained khaki nylon of his windbreaker. Threading his way through the Ninsei crowds, he could smell his own stale sweat.             Case was twenty-four. At twenty-two, he’d been a cowboy, a rustler, one of the best in the Sprawl. He’d been trained by the best, by McCoy Pauley and Bobby Quine, legends in the biz. He’d operated on an almost permanent adrenaline high, a byproduct of youth and proficiency, jacked into a custom cyberspace deck hat projected his disembodied consciousness into the consensual hallucination that was the matrix. A their, he’d worked for other, wealthier thieves, employers who provided the exotic software required to penetrate the bright walls of corporate systems, opening windows into rich fields of data.'.replaceAll(/\s{2,}/g,`
`),Ht=[{id:"pageUp",text:"page up",onClick:()=>{window._PTR.actions.pageUp()}},{id:"pageDown",text:"page down",onClick:()=>{window._PTR.actions.pageDown()}},{id:"home",text:"home",onClick:()=>{window._PTR.actions.home()}},{id:"end",text:"end",onClick:()=>{window._PTR.actions.end()}},{id:"setText",text:"set text",onClick:()=>{const e=prompt("Define display text");window._PTR.actions.setText(e??"")}},{id:"resetText",text:"EXAMPLE",onClick:()=>{window._PTR.actions.setText(Et)}},{id:"appendText",text:"append text",onClick:()=>{const e=prompt("Append Text");window._PTR.actions.appendText(e??"")}}],O=document.getElementById("devHarnessButtons");Ht.forEach(e=>{const t=document.createElement("button");t.id=e.id,t.innerText=e.text,t.onclick=e.onClick,O==null||O.appendChild(t)});
